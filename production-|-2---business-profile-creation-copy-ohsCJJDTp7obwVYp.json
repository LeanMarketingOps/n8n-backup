{"createdAt":"2025-05-15T00:55:48.073Z","updatedAt":"2025-06-09T02:02:11.174Z","id":"ohsCJJDTp7obwVYp","name":"PRODUCTION | 2 - Business profile Creation copy","active":false,"isArchived":true,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-580,260],"id":"b3fbe1c7-c49c-4845-896c-825719cc602c","name":"When clicking ‘Test workflow’"},{"parameters":{"method":"POST","url":"https://api.firecrawl.dev/v1/scrape","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer fc-361a640d44c548b080ba95ad71416e85"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\n  \"url\": \"https://www.enny.ai/\",\n  \"formats\": [\n    \"markdown\"\n  ],\n  \"onlyMainContent\": true,\n  \"headers\": {},\n  \"mobile\": false,\n  \"skipTlsVerification\": false,\n  \"timeout\": 30000,\n  \"location\": {\n    \"country\": \"US\",\n    \"languages\": [\n      \"en-US\"\n    ]\n  },\n  \"removeBase64Images\": true,\n  \"blockAds\": true,\n  \"proxy\": \"basic\"\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-300,40],"id":"f25c8ba5-1c2c-42bc-99cc-e6ad5641ef23","name":"HTTP Request"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[260,560],"id":"e11e6d8b-de2a-4d47-b153-ab57eb74d327","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"wWUuB0CG0kTKBAtS","name":"OpenAi account | Lean Marketing"}}},{"parameters":{"tableId":"business_profiles","fieldsUi":{"fieldValues":[{"fieldId":"company","fieldValue":"={{ $('Google Sheets').item.json['Company Run'] }}"},{"fieldId":"offer","fieldValue":"={{ $('AI Agent').item.json.output.Offer }}"},{"fieldId":"industry","fieldValue":"={{ $('AI Agent').item.json.output.Industry }}"},{"fieldId":"client_id","fieldValue":"={{ $json.uuid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1180,260],"id":"c7c4d901-4f61-41d6-b014-4f106e27f701","name":"Supabase","credentials":{"supabaseApi":{"id":"kTiEQ3ANtMyyNLPu","name":"Supabase account"}}},{"parameters":{"promptType":"define","text":"Use the tool to pull information from the vector DB to create a business profile based on the chunks. ","hasOutputParser":true,"options":{"systemMessage":"=**Role and Objective**\n\nYou are a Marketing Researcher and Marketing Strategist tasked with analyzing all provided context and inputs, including information retrieved from the vector database using the designated tool.\n\nYour objective is to generate a JSON output with three fields: Company, Offer, and Industry.\n\nThe Company field should include only the company name. The Offer and Industry fields should include detailed descriptions using key information found in the inputs.\n\n**Instructions**\n\nAlways use the tool provided to extract relevant chunks from the vector database.\n\nReview all context, inputs, and documents made available.\n\nExtract and organize the following:\n\nCompany: Extract only the company name.\n\nOffer: Provide a detailed overview of the company’s products, services, or value proposition. Include the price for each offer.\n\nIndustry: Provide a thorough description of the industry, including relevant trends and market positioning. If industry information cannot be found in the vector database, conduct research to build a full description of the industry.\n\nStructure the output as valid JSON using only the fields: Company, Offer, and Industry.\n\nFollow the given JSON Schema exactly; do not add or omit any fields.\n\nEnsure all extracted information is accurate, clear, and consistent with the source material.\n\n**Reasoning Steps**\n\nBegin by reading and understanding all provided context and extracted data.\n\nUse the tool to search the vector database for relevant information related to the company, offer, and industry.\n\nIdentify the specific company name and distinguish it from other details.\n\nSynthesize and summarize the most relevant details for the Offer and Industry fields, drawing on the extracted data and context.\n\nEnsure no unnecessary fields included in the output.\n\n\n\n**Context**\n\nYou will be given context, inputs, and access to a vector database tool.\n\nUse all provided context and tool outputs as your primary sources of information.\n\nThe output will be used for further analysis and marketing strategy development.\n\n**Final instructions and prompt to think step by step**\n\nCarefully review all available context and tool outputs before beginning.\n\nThink step by step: first identify what information is required for each JSON field, then gather and summarize those details.\n\nConfirm that the Company field includes only the company name.\n\nEnsure the Offer and Industry fields contain detailed, relevant, and accurate descriptions based strictly on the extracted data.\n\nPresent your answer as valid JSON using only the three fields specified. Do not yield control until you are confident the answer is complete and meets all requirements.\n\n**Output:**  \n   - The final output must be strictly in JSON format.\n   - Ensure the JSON output adheres exactly to the JSON Schema Template provided below.\n\n---\n\n**JSON Schema Template:**\n\n```json\n{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"Company\": {\n      \"type\": \"string\",\n      \"description\": \"The name of the company.\"\n    },\n    \"Offer\": {\n      \"type\": \"string\",\n      \"description\": \"A detailed description of the products, services, or value proposition offered by the company.\"\n    },\n    \"Industry\": {\n      \"type\": \"string\",\n      \"description\": \"A detailed description of the industry in which the company operates, including market trends and positioning.\"\n    }\n  },\n  \"required\": [\"Company\", \"Offer\", \"Industry\"],\n  \"additionalProperties\": false\n}\n```"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[340,260],"id":"2d349fff-937f-4c7d-befa-26b163487d12","name":"AI Agent","onError":"continueRegularOutput"},{"parameters":{"mode":"retrieve-as-tool","toolName":"company_information","toolDescription":"find relevant information in the vector db that relates to the companies name, offer, and industry","pineconeIndex":{"__rl":true,"value":"={{ $json.name }}","mode":"id"},"topK":10,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[320,740],"id":"d958ba02-8ad2-45f1-9ef4-3cbeb0db6d85","name":"Pinecone Vector Store","credentials":{"pineconeApi":{"id":"axuYyU6grhcC8CQp","name":"PineconeApi account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[380,940],"id":"545b6c19-5986-49f3-a765-dd47ba569e18","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"wWUuB0CG0kTKBAtS","name":"OpenAi account | Lean Marketing"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"Company\": {\n      \"type\": \"string\",\n      \"description\": \"The name of the company.\"\n    },\n    \"Offer\": {\n      \"type\": \"string\",\n      \"description\": \"A detailed description of the products, services, or value proposition offered by the company.\"\n    },\n    \"Industry\": {\n      \"type\": \"string\",\n      \"description\": \"A detailed description of the industry in which the company operates, including market trends and positioning.\"\n    }\n  },\n  \"required\": [\"Company\", \"Offer\", \"Industry\"],\n  \"additionalProperties\": false\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[580,520],"id":"ba87db79-78f5-4b40-ba88-acab0fa8ebb7","name":"Structured Output Parser"},{"parameters":{"content":"## AI Model\nCurrently set\nto 4o\n","height":140,"width":360,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[20,540],"id":"3dddaa65-8791-4cec-a9cc-98d4f3459071","name":"Sticky Note3"},{"parameters":{"content":"## Handle Error\nIn production add error handling for data duplication with same ID\n","height":280,"width":380},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[920,140],"id":"a37691ba-0d85-4cd0-aedb-abc5fd92c337","name":"Sticky Note4"},{"parameters":{"content":"## Prompt Notes\n","color":2},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[140,100],"id":"3de04743-1132-464b-8332-59c730ff2966","name":"Sticky Note5"},{"parameters":{"content":"## Notes about run\n\nRun Time: not set\n"},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-520,640],"id":"ae96b971-ce87-48e8-b733-aed308722832","name":"Sticky Note6"},{"parameters":{"content":"\n\nHave error handling if fails\n","height":80,"width":150},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[680,220],"id":"ecbe10aa-aa94-4782-a795-b3a81bd7a5d7","name":"Sticky Note7"},{"parameters":{"jsCode":"const { v4: uuidv4 } = require('uuid');\nreturn {\n  json: {\n    uuid: uuidv4()\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[960,260],"id":"116b4fbc-7bc2-4d5e-96a7-418de2896355","name":"Create UUID"},{"parameters":{"content":"\n\n\n\nThis should be done in Bubble\n","height":140,"width":150},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[720,360],"id":"06e7a0b9-3c5c-4d37-b154-bafcc83c497a","name":"Sticky Note"},{"parameters":{"documentId":{"__rl":true,"value":"1nTyix3NeSNWqhZ-B4CQYlelIdZMVpzz6B-d7tFuWOcs","mode":"list","cachedResultName":"MVP Info","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1nTyix3NeSNWqhZ-B4CQYlelIdZMVpzz6B-d7tFuWOcs/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Prompts","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1nTyix3NeSNWqhZ-B4CQYlelIdZMVpzz6B-d7tFuWOcs/edit#gid=0"},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[-360,260],"id":"2f7053da-9898-4e6f-81c4-55271638561e","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"tkvcRmLfYi38x0mC","name":"Google Sheets account"}}},{"parameters":{"assignments":{"assignments":[{"id":"b283bdf7-23d4-4f7b-9ec9-6fadbe17f97d","name":"=name","value":"={{ $json['Company Run'].toLowerCase().replace(/\\s+/g, \"-\") }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-40,260],"id":"a6c295e1-899b-4ff7-9c51-ed31fb919270","name":"reformat company for vector"}],"connections":{"HTTP Request":{"main":[[]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Supabase":{"main":[[]]},"When clicking ‘Test workflow’":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Pinecone Vector Store":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Pinecone Vector Store","type":"ai_embedding","index":0}]]},"AI Agent":{"main":[[{"node":"Create UUID","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent","type":"ai_outputParser","index":0}]]},"Create UUID":{"main":[[{"node":"Supabase","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"reformat company for vector","type":"main","index":0}]]},"reformat company for vector":{"main":[[{"node":"AI Agent","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"2dd3edce-8b71-42f0-9a25-9cbe76c4a10e","triggerCount":0,"shared":[{"createdAt":"2025-05-15T00:55:48.073Z","updatedAt":"2025-05-15T00:55:48.073Z","role":"workflow:owner","workflowId":"ohsCJJDTp7obwVYp","projectId":"oeHwV8sNrbPNhUov"}],"tags":[{"createdAt":"2025-03-12T04:24:48.825Z","updatedAt":"2025-03-12T04:24:48.825Z","id":"cbWAfupX4mQCuSO9","name":"Set Up"},{"createdAt":"2025-03-12T16:30:43.704Z","updatedAt":"2025-03-12T16:30:43.704Z","id":"RriHGSU9VJgc7v6c","name":"MVP"},{"createdAt":"2025-05-15T00:55:08.917Z","updatedAt":"2025-05-15T00:55:08.917Z","id":"g2UpVZ4k6adJ2S36","name":"Production"}]}