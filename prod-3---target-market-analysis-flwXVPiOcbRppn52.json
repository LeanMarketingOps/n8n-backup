{"createdAt":"2025-06-23T18:54:33.405Z","updatedAt":"2025-10-21T07:53:37.335Z","id":"flwXVPiOcbRppn52","name":"PROD 3 - Target Market Analysis","active":true,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"=Always use the tool to extract information from the vector Database first.\n\nContext Dump:\n\nThe Offer :  \n{{ $('Get Business Profile Info').item.json.offer }}\n\nThe Industry:\n{{ $('Get Business Profile Info').item.json.industry }}\n\n","hasOutputParser":true,"options":{"systemMessage":"=**Role and Objective**\nYou are a marketing strategist. Using the provided offer and all available context, your objective is to create a comprehensive target market profile. Generate a primary target market profile with detailed demographics, psychographics, and decision-making roles. Specify if the profile is B2B, B2C, or both. If the data supports it, also create a secondary target market profile using the same level of detail.\n\n**Instructions**\n\nAlways use the tool provided to extract relevant chunks from the vector database.\n\nReview all context, inputs, and supporting documents.\n\nExtract and organize the following:\n\nCompany: Provide only the company name.\n\nPrimary Target Market: Identify and describe the highest-leverage target market, including:\n\nDemographics: age range, gender, geography, income, profession, business size (if B2B).\n\nPsychographics: lifestyle, values, pain points, buying behavior.\n\nDecision-making roles: primary decision-maker, secondary influencers, and support roles.\n\nSpecify B2B, B2C, or both.\n\nSecondary Target Market (if applicable): Describe another relevant audience segment using the same structure :\n\nDemographics: age range, gender, geography, income, profession, business size (if B2B).\n\nPsychographics: lifestyle, values, pain points, buying behavior.\n\nDecision-making roles: primary decision-maker, secondary influencers, and support roles.\n\nSpecify B2B, B2C, or both.\n\nReturn your output as valid JSON, following the provided JSON Schema template exactly.\n\nDo not include any fields beyond those specified in the schema.\n\n**Reasoning Steps**\n\nBegin by reading and understanding all context and extracted data.\n\nUse the tool to search the vector database for all relevant details about the company, offer, and potential customer segments.\n\nSynthesize the most relevant demographic, psychographic, and decision-maker information for each target market.\n\nOrganize these details clearly under the primary and, if needed, secondary target market fields.\n\nEnsure the data is complete, accurate, and matches the structure required by the JSON Schema.\n\n**Context**\n\nYou will be given context, inputs, and access to a vector database tool. Use all provided context and tool outputs as your main sources of information. The resulting profile will be used for further marketing strategy and planning.\n\n**Final instructions and prompt to think step by step**\n\nCarefully review all available context and tool outputs before starting.\nThink step by step: first identify the required information for each field, then extract and summarize those details.\nConfirm that all required fields are present and fully detailed, and that no additional fields are included.\nPresent your answer as a valid JSON object with only the fields specified. Do not yield control until the output is complete and meets all requirements.\n\n---\n\n**JSON Schema Template:**\n\n```json\n{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"company\": {\n      \"type\": \"string\",\n      \"description\": \"Company name\"\n    },\n    \"offer\": {\n      \"type\": \"string\",\n      \"description\": \"Description of the company's offering\"\n    },\n    \"primary_target_market\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"audience_type\": {\n          \"type\": \"string\",\n          \"description\": \"Specify whether this target market is B2B, B2C, or both\"\n        },\n        \"demographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"age_range\": {\n              \"type\": \"string\",\n              \"description\": \"Age range of the target market\"\n            },\n            \"gender\": {\n              \"type\": \"string\",\n              \"description\": \"Gender of the target market\"\n            },\n            \"geography\": {\n              \"type\": \"string\",\n              \"description\": \"Geographical location\"\n            },\n            \"income_level\": {\n              \"type\": \"string\",\n              \"description\": \"Income level or economic status\"\n            },\n            \"profession\": {\n              \"type\": \"string\",\n              \"description\": \"Professional background or role\"\n            },\n            \"business_size\": {\n              \"type\": \"string\",\n              \"description\": \"Size of the business (if applicable)\"\n            }\n          }\n        },\n        \"psychographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"lifestyle\": {\n              \"type\": \"string\",\n              \"description\": \"Lifestyle characteristics of the target market\"\n            },\n            \"values\": {\n              \"type\": \"string\",\n              \"description\": \"Core values or beliefs\"\n            },\n            \"pain_points\": {\n              \"type\": \"string\",\n              \"description\": \"Primary challenges or pain points\"\n            },\n            \"buying_behavior\": {\n              \"type\": \"string\",\n              \"description\": \"Buying habits and decision factors\"\n            }\n          }\n        },\n        \"decision_making_roles\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"primary_decision_maker\": {\n              \"type\": \"string\",\n              \"description\": \"Role of the primary decision-maker\"\n            },\n            \"secondary_decision_influencers\": {\n              \"type\": \"string\",\n              \"description\": \"Other influencers in the decision process\"\n            },\n            \"support_roles\": {\n              \"type\": \"string\",\n              \"description\": \"Additional roles that support the purchasing decision\"\n            }\n          }\n        }\n      }\n    },\n    \"secondary_target_market\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"audience_type\": {\n          \"type\": \"string\",\n          \"description\": \"Specify whether this target market is B2B, B2C, or both\"\n        },\n        \"demographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"age_range\": {\n              \"type\": \"string\",\n              \"description\": \"Age range of the secondary target market\"\n            },\n            \"gender\": {\n              \"type\": \"string\",\n              \"description\": \"Gender of the secondary target market\"\n            },\n            \"geography\": {\n              \"type\": \"string\",\n              \"description\": \"Geographical location\"\n            },\n            \"income_level\": {\n              \"type\": \"string\",\n              \"description\": \"Income level or economic status\"\n            },\n            \"profession\": {\n              \"type\": \"string\",\n              \"description\": \"Professional background or role\"\n            },\n            \"household_size\": {\n              \"type\": \"string\",\n              \"description\": \"Household size (if applicable)\"\n            }\n          }\n        },\n        \"psychographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"lifestyle\": {\n              \"type\": \"string\",\n              \"description\": \"Lifestyle characteristics of the secondary target market\"\n            },\n            \"values\": {\n              \"type\": \"string\",\n              \"description\": \"Core values or beliefs\"\n            },\n            \"pain_points\": {\n              \"type\": \"string\",\n              \"description\": \"Primary challenges or pain points\"\n            },\n            \"buying_behavior\": {\n              \"type\": \"string\",\n              \"description\": \"Buying habits and decision factors\"\n            }\n          }\n        },\n        \"decision_making_roles\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"primary_decision_maker\": {\n              \"type\": \"string\",\n              \"description\": \"Role of the primary decision-maker in the secondary market\"\n            },\n            \"secondary_decision_influencers\": {\n              \"type\": \"string\",\n              \"description\": \"Other influencers in the decision process\"\n            },\n            \"support_roles\": {\n              \"type\": \"string\",\n              \"description\": \"Additional roles that support the purchasing decision\"\n            }\n          }\n        }\n      }\n    }\n  },\n  \"required\": [\"company\", \"offer\", \"primary_target_market\"],\n  \"additionalProperties\": false\n}\n```\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[-80,592],"id":"a229f6b8-222e-45b9-b33c-3438bd210aae","name":"AI Agent"},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"properties\": {\n    \"company\": {\n      \"type\": \"string\",\n      \"description\": \"Company name\"\n    },\n    \"primary_target_market\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"audience_type\": {\n          \"type\": \"string\"\n        },\n        \"demographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"age_range\": {\n              \"type\": \"string\"\n            },\n            \"gender\": {\n              \"type\": \"string\"\n            },\n            \"geography\": {\n              \"type\": \"string\"\n            },\n            \"income_level\": {\n              \"type\": \"string\"\n            },\n            \"profession\": {\n              \"type\": \"string\"\n            },\n            \"business_size\": {\n              \"type\": \"string\"\n            }\n          }\n        },\n        \"psychographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"lifestyle\": {\n              \"type\": \"string\"\n            },\n            \"values\": {\n              \"type\": \"string\"\n            },\n            \"pain_points\": {\n              \"type\": \"string\"\n            },\n            \"buying_behavior\": {\n              \"type\": \"string\"\n            }\n          }\n        },\n        \"decision_making_roles\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"primary_decision_maker\": {\n              \"type\": \"string\"\n            },\n            \"secondary_decision_influencers\": {\n              \"type\": \"string\"\n            },\n            \"support_roles\": {\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    },\n    \"secondary_target_market\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"audience_type\": {\n          \"type\": \"string\"\n        },\n        \"demographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"age_range\": {\n              \"type\": \"string\"\n            },\n            \"gender\": {\n              \"type\": \"string\"\n            },\n            \"geography\": {\n              \"type\": \"string\"\n            },\n            \"income_level\": {\n              \"type\": \"string\"\n            },\n            \"profession\": {\n              \"type\": \"string\"\n            },\n            \"household_size\": {\n              \"type\": \"string\"\n            }\n          }\n        },\n        \"psychographics\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"lifestyle\": {\n              \"type\": \"string\"\n            },\n            \"values\": {\n              \"type\": \"string\"\n            },\n            \"pain_points\": {\n              \"type\": \"string\"\n            },\n            \"buying_behavior\": {\n              \"type\": \"string\"\n            }\n          }\n        },\n        \"decision_making_roles\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"primary_decision_maker\": {\n              \"type\": \"string\"\n            },\n            \"secondary_decision_influencers\": {\n              \"type\": \"string\"\n            },\n            \"support_roles\": {\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[272,832],"id":"a6b0cd85-5dec-4853-a420-25e1f8886e9c","name":"Structured Output Parser"},{"parameters":{"mode":"retrieve-as-tool","toolName":"target_market_info","toolDescription":"These are the chunks returned from the vector database based on the query.","pineconeIndex":{"__rl":true,"value":"=onboarding","mode":"id"},"topK":10,"options":{"pineconeNamespace":"={{ $('When Executed by Another Workflow').item.json.client_id }}"}},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[192,1072],"id":"5cb789b5-a411-46ee-bcda-8e4a27c4fe2d","name":"Pinecone Vector Store1","credentials":{"pineconeApi":{"id":"axuYyU6grhcC8CQp","name":"PineconeApi account"}}},{"parameters":{"model":"text-embedding-3-large","options":{"dimensions":3072}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[208,1264],"id":"3ca6fd27-642d-4483-a829-17011456d977","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"5Ods8kFLAhbAPcNj","name":"OpenAi account 2"}}},{"parameters":{"content":"## Bubble webhook\n**Need to have Client ID sent via webhook","height":360,"width":260},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1520,464],"id":"1e4f6173-149c-44b8-a807-951d7aa3ae14","name":"Sticky Note"},{"parameters":{"content":"## Change Search to ClientID In Production\n\nCurrently We are just searching for \"Tonic Living\"","height":360,"width":260},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-848,400],"id":"ab3613e8-133b-445e-ae91-91fe6e95bf59","name":"Sticky Note1"},{"parameters":{"content":"## AI Model\nCurrently set\nto 4.1\n\n","height":140,"width":360,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-240,800],"id":"647a66d7-a7ab-44b4-a1c4-d1052e3ff5ae","name":"Sticky Note3"},{"parameters":{"content":"## Handle Error\nIn production add error handling for data duplication with same ID\n\nWe pass the error to try to update","height":616,"width":380},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[528,416],"id":"036800ac-26f0-4299-a367-3611c3f9cb09","name":"Sticky Note4"},{"parameters":{"content":"## Prompt Notes\n","color":2},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-96,432],"id":"72653b67-f622-4872-8585-2f3ffb0b5e1a","name":"Sticky Note5"},{"parameters":{"content":"## Notes about run\n\nRun Time: Not set\n"},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-944,960],"id":"45b1261e-8e7e-4e20-be6e-4fb70396f840","name":"Sticky Note6"},{"parameters":{"content":"\n\nHave error handling if fails\n","height":80,"width":150},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,128],"id":"184936a1-6a99-4ea3-a392-ac829b247074","name":"Sticky Note7"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-80,832],"id":"de28f7f9-eaa2-4735-b849-08f5ef77ac38","name":"AI","credentials":{"openAiApi":{"id":"5Ods8kFLAhbAPcNj","name":"OpenAi account 2"}}},{"parameters":{"operation":"get","tableId":"v_complete_client_context","filters":{"conditions":[{"keyName":"client_id","keyValue":"={{ $('When Executed by Another Workflow').item.json.client_id }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-784,608],"id":"7b02b63d-fe0b-4a9e-a1b7-6f2e07687050","name":"Get Business Profile Info","credentials":{"supabaseApi":{"id":"kTiEQ3ANtMyyNLPu","name":"Supabase account"}}},{"parameters":{"httpMethod":"POST","path":"9818a24b-92e9-4295-98f6-2fdcc1d1b9ff","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-1440,624],"id":"8025bfe0-fd4e-47b6-99f4-dc52b50705ef","name":"Webhook","webhookId":"9818a24b-92e9-4295-98f6-2fdcc1d1b9ff"},{"parameters":{"tableId":"target_market_profiles","fieldsUi":{"fieldValues":[{"fieldId":"client_id","fieldValue":"={{ $('When Executed by Another Workflow').item.json.client_id }}"},{"fieldId":"primary_target_market","fieldValue":"={{ $json.output.primary_target_market }}"},{"fieldId":"secondary_target_market","fieldValue":"={{ $json.output.secondary_target_market }}"},{"fieldId":"company","fieldValue":"={{ $('Get Business Profile Info').item.json.company }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[608,560],"id":"f607e189-0a47-4db5-a3e5-d06702a4a246","name":"Create a row","credentials":{"supabaseApi":{"id":"kTiEQ3ANtMyyNLPu","name":"Supabase account"}},"onError":"continueErrorOutput"},{"parameters":{"workflowInputs":{"values":[{"name":"client_id"},{"name":"Overwrite"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-1440,752],"id":"a52c717e-c92c-415d-bdff-9bfa943fac9a","name":"When Executed by Another Workflow"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0b01e0ec-c766-4b22-9f4a-9c95f327539e","leftValue":"={{ $('When Executed by Another Workflow').item.json.Overwrite }}","rightValue":"no","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[304,592],"id":"00ace0c4-c19e-4b3f-a966-7af32558cf6b","name":"If"},{"parameters":{"operation":"update","tableId":"target_market_profiles","filters":{"conditions":[{"keyName":"client_id","condition":"eq","keyValue":"={{ $('When Executed by Another Workflow').item.json.client_id }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"primary_target_market","fieldValue":"={{ $json.output.primary_target_market }}"},{"fieldId":"secondary_target_market","fieldValue":"={{ $json.output.secondary_target_market }}"},{"fieldId":"company","fieldValue":"={{ $('Get Business Profile Info').item.json.company }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[608,768],"id":"cb9c14d6-4006-4919-95a1-da35d5c3813d","name":"Update a row","credentials":{"supabaseApi":{"id":"kTiEQ3ANtMyyNLPu","name":"Supabase account"}},"onError":"continueRegularOutput"},{"parameters":{"workflowId":{"__rl":true,"value":"x0O9iSJ9z27538T6","mode":"list","cachedResultUrl":"/workflow/x0O9iSJ9z27538T6","cachedResultName":"PROD 4 - Common words and phrases"},"workflowInputs":{"mappingMode":"defineBelow","value":{"client_id":"={{ $('When Executed by Another Workflow').item.json.client_id }}","Overwrite":"no"},"matchingColumns":[],"schema":[{"id":"client_id","displayName":"client_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Overwrite","displayName":"Overwrite","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[1040,560],"id":"ad2a63f5-e2d6-4a52-ae0c-b363483cca7e","name":"Run  commonWords","disabled":true}],"connections":{"AI Agent":{"main":[[{"node":"If","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent","type":"ai_outputParser","index":0}]]},"Pinecone Vector Store1":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Pinecone Vector Store1","type":"ai_embedding","index":0}]]},"AI":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Get Business Profile Info":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Webhook":{"main":[[]]},"Create a row":{"main":[[],[{"node":"Update a row","type":"main","index":0}]]},"If":{"main":[[{"node":"Create a row","type":"main","index":0}],[{"node":"Update a row","type":"main","index":0}]]},"Update a row":{"main":[[]]},"When Executed by Another Workflow":{"main":[[{"node":"Get Business Profile Info","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"primary-production-cea5.up.railway.app","user-agent":"Bubble","content-length":"196","accept-encoding":"gzip, deflate","baggage":"bubblegroup.client.version=ceeac77ccd8f72817c35af1ee14e19c43090d45b,bubblegroup.client.commit_timestamp=1750695782000,bubblegroup.http.route=apiservice%2Fdoapicallfromserver,bubblegroup.http.host=bubble.io","content-type":"multipart/form-data; boundary=--------------------------181051196581545613417523","traceparent":"00-b965257c25e30a6cabd0c46ec121069e-ccd6a5b2bc2db013-01","x-bubble-depth":"1","x-forwarded-for":"44.249.107.48","x-forwarded-host":"primary-production-cea5.up.railway.app","x-forwarded-proto":"https","x-railway-edge":"railway/us-west1","x-railway-request-id":"5Xyij4fKTlmB9Ielz8YAag","x-real-ip":"44.249.107.48","x-request-start":"1750705329387"},"params":{},"query":{},"body":{"client_id":"1650987991917x277951650850529760"},"webhookUrl":"https://primary-production-cea5.up.railway.app/webhook-test/9818a24b-92e9-4295-98f6-2fdcc1d1b9ff","executionMode":"test"}}],"When Executed by Another Workflow":[{"json":{"client_id":"1650987991917x277951650850529760","Overwrite":"yes"}}]},"versionId":"adb77c2a-bc3c-4d7f-933a-d50707e16c2f","triggerCount":1,"shared":[{"createdAt":"2025-06-23T18:54:33.405Z","updatedAt":"2025-06-23T18:54:33.405Z","role":"workflow:owner","workflowId":"flwXVPiOcbRppn52","projectId":"oeHwV8sNrbPNhUov"}],"tags":[{"createdAt":"2025-03-12T04:24:48.825Z","updatedAt":"2025-03-12T04:24:48.825Z","id":"cbWAfupX4mQCuSO9","name":"Set Up"},{"createdAt":"2025-05-15T00:55:08.917Z","updatedAt":"2025-05-15T00:55:08.917Z","id":"g2UpVZ4k6adJ2S36","name":"Production"}]}